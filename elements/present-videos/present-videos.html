<link rel="import" href="../../bower_components/polymer/polymer.html">
<dom-module id="present-videos">
<template>
	<google-youtube id="googleYouTube"
	fluid="true"
	chromeless="true"
	on-google-youtube-state-change="handleStateChange"></google-youtube>
</template>

<script>
(function() {

	Polymer({
		is: 'present-videos',

		properties: {

		},

		handleStateChange: function(ev) {
			var videoState = ev.detail.data
			console.log("State change to: " + videoState);
			if (videoState == 0) {
				console.log("Video just ended.");
			} else if (videoState == 1) {
				console.log("Playing");
			}
		},
		ready: function() {
			// Get a database reference to our posts
			var youtubePlayer = this.$.googleYouTube;
			var ref = new Firebase('https://fisherchristmas2015.firebaseio.com/');
			ref.child("mckinley").on("child_changed", function(snapshot) {


				console.log("McKinley " + snapshot.key() + " value is now " + snapshot.val());
				if (snapshot.val() == "NEEDS_TO_PLAY") {

					switch(snapshot.key()) {
						case "1":
						console.log("Set the video id for video 1 to ZbtkDencIyE");
						youtubePlayer.videoId = "ZbtkDencIyE";
						break;
						case "2":
						console.log("Set the video id for video 2");
						break;
						case "3":
						console.log("Set the video id for video 3");
						break;
						case "4":
						console.log("Set the video id for video 4");
						break;
						case "5":
						console.log("Set the video id for video 5");
						break;
						case "6":
						console.log("Set the video id for video 6");
						break;
					}
					youtubePlayer.play();
					setTimeout(function() {
						ref.child("mckinley").child(snapshot.key()).set("PLAYED");
						youtubePlayer.pause();
						}, 8000);
					}
				}, function (errorObject) {
					console.log("The McKinley read failed: " + errorObject.code);
				});


				ref.child("keegan").on("child_changed", function(snapshot) {
					console.log("McKinley " + snapshot.key() + " value is now " + snapshot.val());
				}, function (errorObject) {
					console.log("The McKinley read failed: " + errorObject.code);
				});



				console.log("Loaded Firebase listeners!");
			}
		});
		})();
		</script>

	</dom-module>
